---

# CONTEXT SNAPSHOT · STAM RT FRAMEWORK

## 1. Общая цель проекта

Разрабатывается **переиспользуемый RT execution-framework**, основанный на:

```
Separated Task Application Model (STAM)
```

Ключевая идея:

```
RT — это частный режим исполнения,
а не основа архитектуры.
```

---

## 2. Архитектурные слои (зафиксированы окончательно)

```
sys     → платформенный контракт (CPU, компилятор, барьеры, время)
model   → метаданные состояния (Registry, snapshot, без истории)
exec    → выполнение БЕЗ времени (примитивы, задачи, публикации)
rtr     → real-time runtime (scheduler, time, safety)
modules → опциональные библиотечные подсистемы (logging и др.)
apps    → прикладные системы
tools   → внешние non-RT утилиты
tests   → unit / integration / contracts
```

Главные инварианты:

* **Registry = snapshot-модель без истории**
* **Exec не зависит от RT**
* **RTR содержит только время / планирование / safety**
* **Logging — optional module, не core**
* **Зависимости только вниз по слоям**

---

## 3. Структура репозитория (актуальная)

```
include/
  sys/
  model/
  exec/
  rtr/
  modules/logging/

src/
  rtr/
  modules/logging/

modules/
  logging/        ← CMake-узел модуля

apps/
  brewery/
  minimal/

tests/
  unit/
  integration/
  contracts/
```

Архитектура файловой системы признана **чистой и завершённой**.

---

## 4. Namespace-стратегия

### Root namespace выбран:

```
namespace stam
```

Причина:

* отражает **архитектурную модель**, а не компанию или RT
* масштабируется на будущие библиотеки
* не привязан к реализации

---

### ABI-будущее предусмотрено

Добавлен root-header с поддержкой:

```
inline versioned namespace (stam::v1)
```

Сейчас используется **plain `stam`**,
но возможен переход **без переписывания кода**.

---

## 5. Logging-позиционирование

Логирование:

```
- не RT
- не safety
- не core
- переиспользуемый optional механизм
```

Размещено в:

```
modules/logging
```

Core-слои **не зависят** от него.

---

## 6. CMake-граф (слоистый)

```
core_sys
  → core_model
      → core_exec
          → core_rtr
              → module_logging
                  → apps
```

`tests/unit` собираются **только с core_exec**
→ проверка чистоты архитектуры.

---

## 7. Текущий статус проекта

Завершены:

* архитектурная стратификация
* файловая структура
* namespace-стратегия
* ABI-основа
* CMake-каркас

Проект перешёл из стадии:

```
архитектурное проектирование
→
инженерная реализация
```

---

## 8. Логически следующий шаг разработки

Следующая ключевая тема:

```
ФОРМАЛЬНЫЙ ABI-КОНТРАКТ:

Task
State
Registry
Publication
```

Это переход:

```
framework skeleton → настоящая RT-платформа
```

---
