#pragma once

//------------------------------------------------------------------------------
// STAM — root namespace control
//
// Цели:
//  - сегодня: plain namespace stam
//  - завтра:  versioned ABI namespace (stam::v1)
//  - без переписывания пользовательского кода
//------------------------------------------------------------------------------

//------------------------------------------------------------------------------
// 1. Конфигурация ABI-версии
//
// Если когда-нибудь понадобится:
//   #define STAM_ABI_VERSION v1
// до подключения заголовков библиотеки.
//------------------------------------------------------------------------------

#ifndef STAM_ABI_VERSION
    #define STAM_ABI_VERSION /* empty */
#endif

//------------------------------------------------------------------------------
// 2. Вспомогательные макросы для inline-namespace
//------------------------------------------------------------------------------

#define STAM_DETAIL_NS_CONCAT(a, b) a::b
#define STAM_DETAIL_NS_EVAL(a, b)   STAM_DETAIL_NS_CONCAT(a, b)

//------------------------------------------------------------------------------
// 3. Открытие / закрытие root namespace
//------------------------------------------------------------------------------

#ifdef STAM_ABI_VERSION

namespace stam {
inline namespace STAM_ABI_VERSION {

#else

namespace stam {

#endif

//------------------------------------------------------------------------------
// 4. Макросы-обёртки (для единообразия в коде)
//------------------------------------------------------------------------------

#define STAM_BEGIN_NAMESPACE \
    namespace stam {         \
    STAM_DETAIL_ABI_NS_BEGIN

#define STAM_END_NAMESPACE   \
    STAM_DETAIL_ABI_NS_END   \
    }


//------------------------------------------------------------------------------
// 5. Закрытие namespace
//------------------------------------------------------------------------------

#ifdef STAM_ABI_VERSION

} // inline namespace STAM_ABI_VERSION
} // namespace stam

#else

} // namespace stam

#endif
